<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        friends | 让正确的事情持续发生——永远年轻，永远热泪盈眶
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Steam">
    <meta name="description" content="Steam&#39;s Blog">
    <meta name="keywords" content="null">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="让正确的事情持续发生——永远年轻，永远热泪盈眶">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://beamaster.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="friends | 让正确的事情持续发生——永远年轻，永远热泪盈眶">
    <meta property="og:description" content="Steam&#39;s Blog">
    <!-- <script>
    (function(){
      if('{{ page.password }}'){
        if (prompt('请输入文章密码','') !== '{{ page.password }}'){
          alert('密码错误！');
          history.back();
        }
      }
    })();
    </script> -->

     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>

	<link rel="stylesheet" href="/css/highlight/solarized-white.css">

	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>


  <!-- 文章加密 设置-->

    <!-- Custom Head -->
    
</head>

	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                <!-- Post TOC -->


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 30 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            friends
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Steam</strong>
        <span>12月 31, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->

    <!-- Qrcode -->
    


    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">

    

    
    <!-- Busuanzi Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="busuanzi_container_page_pv">
                <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
            </span>
        </li>
    </a>
    

    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=friends&url=http://beamaster.github.io//friends/index.html&via=Steam" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>

    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://beamaster.github.io//friends/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>

    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=friends&url=http://beamaster.github.io//friends/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>

    <!-- Share LinkedIn -->
    <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://beamaster.github.io//friends/index.html&title=friends" target="_blank">
        <li class="mdl-menu__item">
            分享到 LinkedIn
        </li>
    </a>

    <!-- Share QQ -->
    <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=让正确的事情持续发生——永远年轻，永远热泪盈眶&title=friends&summary=Steam&#39;s Blog&pics=http://beamaster.github.io/img/favicon.png&url=http://beamaster.github.io/friends/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 QQ
        </li>
    </a>

    <!-- Share Telegram -->
    <a class="post_share-link" href="https://telegram.me/share/url?url=http://beamaster.github.io/friends/index.html&text=friends" target="_blank">
        <li class="mdl-menu__item">
            分享到 Telegram
        </li>
    </a>
</ul>

</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div></pre></td><td class="code"><pre><div class="line">// ==UserScript==</div><div class="line">// @name Download YouTube Videos as MP4</div><div class="line">// @description Adds a button that lets you download YouTube videos.</div><div class="line">// @homepageURL https://github.com/gantt/downloadyoutube</div><div class="line">// @author Gantt</div><div class="line">// @version 1.8.8</div><div class="line">// @date 2016-09-02</div><div class="line">// @namespace http://googlesystem.blogspot.com</div><div class="line">// @include http://www.youtube.com/*</div><div class="line">// @include https://www.youtube.com/*</div><div class="line">// @exclude http://www.youtube.com/embed/*</div><div class="line">// @exclude https://www.youtube.com/embed/*</div><div class="line">// @match http://www.youtube.com/*</div><div class="line">// @match https://www.youtube.com/*</div><div class="line">// @match http://s.ytimg.com/yts/jsbin/html5player*</div><div class="line">// @match https://s.ytimg.com/yts/jsbin/html5player*</div><div class="line">// @match http://manifest.googlevideo.com/*</div><div class="line">// @match https://manifest.googlevideo.com/*</div><div class="line">// @match http://*.googlevideo.com/videoplayback*</div><div class="line">// @match https://*.googlevideo.com/videoplayback*</div><div class="line">// @match http://*.youtube.com/videoplayback*</div><div class="line">// @match https://*.youtube.com/videoplayback*</div><div class="line">// @connect googlevideo.com</div><div class="line">// @connect ytimg.com</div><div class="line">// @grant GM_xmlhttpRequest</div><div class="line">// @grant GM_getValue</div><div class="line">// @grant GM_setValue</div><div class="line">// @run-at document-end</div><div class="line">// @license MIT License</div><div class="line">// @icon data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAB3RJTUUH2wMOCgIoGUYEAQAAAAlwSFlzAAALEgAACxIB0t1+/AAAAARnQU1BAACxjwv8YQUAAAGSUExURfi/JO/v797e3sbGxq2traWlpZSUlJycnNbW1oyEhIRaWow5OZQhIZwYGKUQEKUICK0ICJQxMYxKSoxzc4x7e4RCQpQYGKUAAK0AALUAAL0AAK0QEIxra5QpKa0YGIxSUsYAAKUhIZR7e87Ozr0ICJRSUr29vYxjY6U5OaUpKa0hIb21tZwAALUICO/Ozu/GxqUxMZSEhLUYGO/W1r0YGKVCQpQQEL0pKffe3vfW1pxra5Q5OcZCQvfn585CQr2trZx7e8ZSUs5SUq05Oc5jY9ZjY84AAKWMjM5zc957e60pKdaMjOelpbWcnLWUlLVCQsYYGMYICNbOzpQICMYhIbV7e5xaWt6cnPfv79bGxt6lpe+9vc5KSs6lpb0xMc6EhM69vbUxMbUhIb1aWs61tcZaWuecnMYxMb1KSsZjY96UlNa1td7W1r17e9a9vZwQEN6trb1jY8YQENZra+fOzr1zc85aWufe3t6MjMY5OdZaWt61tdZ7e+/n5+e9vc6MjMZra+/e3ue1tdalpd7GxrUpKalL4aAAAAABdFJOUwBA5thmAAACxklEQVR42uXX/1/SQBgH8NuAoEQ2ijgbBivJLznBAiUUKiyJSgOVAk0tKZKw75mRRt/7v4MBY8ezjW39Vs8v8rqHz/u1jbvbidC/XL8KmcpOqVT6nSjXjooGw8WfFd+QWGfE4oLbtbr++PdMOy0BDYLjEj/0xevfWIyVAI7b/aIj/9WHsRrA8Yf9bqSexVgD4Lic9kWE/LgPwPGfNfJHDO4P8Iuq+S2M9QD8oUp+nxEAcFCtfgIA/14x/9ElAKDQbNQAwN9VAiYEABy0OgsAWAnB/AcBAtVWawkAfJ4CD0BQADZavYcQgI9h3CCQjpD5PcEgwG+SwLRhIL0vz78SjAPEU3hrHODfyX4I6rUJIP0G3oExoNwFXpoB+HwXmDEFpF9IwKA5YK+Tp9fMAdUOsC6YA553gKcmgdTfAhV1oMQqADndQDmJ0AZLAsFnCIV3VYDHJLAjDkZKciAaFz/lCeBJB1glgXBrNLndBWLJ9uZGAI+keTBLANL8SnWAzWRniAC2pG+6lQF0hfjTqCIBrEvjDwiggFSLuIUoLY0vEwAbUcsnc/LlnO02HGvEz+hXEeJ5Yj+4L2vNkxOJDSnlQzliIq2synr3embiUBjmw0FyU83KX04Ob+9aAK/Ppd5deZloz4HFlCHzt3sX0x2a6LcvQb4ab8r7i+DVdqvnCq/D5ZzqdhfAcr5B9wD0PNwPEu0ZnLwK9oPgNfCQJ2fhhhITJ3E8BjeUOXA+QNQlBh5xLjemVCgKjzgzNIJFjWF4yJoKhafgIWt6VHGmjgR0HvMuTipPdWQJ6AImbBRSE8aY/sC4er5xFx5vHyB4YRRpFWUf0AL4c+dHkHZRFo9TDeB9Aa3Llwjr8FlFwB+wO/rHm0VbPae9mPini/O5h/XGxatw2I6fGHAOuhiGZVxO98lTdgutP94yaIvVdqxZdpvFYTT9X9UfqQQlTXlm8wkAAAAASUVORK5CYII=</div><div class="line">// ==/UserScript==</div><div class="line"></div><div class="line"></div><div class="line">(function () &#123;</div><div class="line">  var FORMAT_LABEL=&#123;'18':'MP4 360p','22':'MP4 720p','43':'WebM 360p','44':'WebM 480p','45':'WebM 720p','46':'WebM 1080p','135':'MP4 480p - no audio','137':'MP4 1080p - no audio','138':'MP4 2160p - no audio','140':'M4A 128kbps - audio','264':'MP4 1440p - no audio','266':'MP4 2160p - no audio','298':'MP4 720p60 - no audio','299':'MP4 1080p60 - no audio'&#125;;</div><div class="line">  var FORMAT_TYPE=&#123;'18':'mp4','22':'mp4','43':'webm','44':'webm','45':'webm','46':'webm','135':'mp4','137':'mp4','138':'mp4','140':'m4a','264':'mp4','266':'mp4','298':'mp4','299':'mp4'&#125;;</div><div class="line">  var FORMAT_ORDER=['18','43','135','44','22','298','45','137','299','46','264','138','266','140'];</div><div class="line">  var FORMAT_RULE=&#123;'mp4':'all','webm':'none','m4a':'all'&#125;;</div><div class="line">  // all=display all versions, max=only highest quality version, none=no version  </div><div class="line">  // the default settings show all MP4 videos</div><div class="line">  var SHOW_DASH_FORMATS=false;</div><div class="line">  var BUTTON_TEXT=&#123;'ar':'تنزيل','cs':'Stáhnout','de':'Herunterladen','en':'Download','es':'Descargar','fr':'Télécharger','hi':'डाउनलोड','hu':'Letöltés','id':'Unduh','it':'Scarica','ja':'ダウンロード','ko':'내려받기','pl':'Pobierz','pt':'Baixar','ro':'Descărcați','ru':'Скачать','tr':'İndir','zh':'下载','zh-TW':'下載'&#125;;</div><div class="line">  var BUTTON_TOOLTIP=&#123;'ar':'تنزيل هذا الفيديو','cs':'Stáhnout toto video','de':'Dieses Video herunterladen','en':'Download this video','es':'Descargar este vídeo','fr':'Télécharger cette vidéo','hi':'वीडियो डाउनलोड करें','hu':'Videó letöltése','id':'Unduh video ini','it':'Scarica questo video','ja':'このビデオをダウンロードする','ko':'이 비디오를 내려받기','pl':'Pobierz plik wideo','pt':'Baixar este vídeo','ro':'Descărcați acest videoclip','ru':'Скачать это видео','tr': 'Bu videoyu indir','zh':'下载此视频','zh-TW':'下載此影片'&#125;;</div><div class="line">  var DECODE_RULE=[];</div><div class="line">  var RANDOM=7489235179; // Math.floor(Math.random()*1234567890);</div><div class="line">  var CONTAINER_ID='download-youtube-video'+RANDOM;</div><div class="line">  var LISTITEM_ID='download-youtube-video-fmt'+RANDOM;</div><div class="line">  var BUTTON_ID='download-youtube-video-button'+RANDOM;</div><div class="line">  var DEBUG_ID='download-youtube-video-debug-info';</div><div class="line">  var STORAGE_URL='download-youtube-script-url';</div><div class="line">  var STORAGE_CODE='download-youtube-signature-code';</div><div class="line">  var STORAGE_DASH='download-youtube-dash-enabled';</div><div class="line">  var isDecodeRuleUpdated=false;  </div><div class="line"></div><div class="line">  start();</div><div class="line"></div><div class="line">function start() &#123;</div><div class="line">  var pagecontainer=document.getElementById('page-container');</div><div class="line">  if (!pagecontainer) return;</div><div class="line">  if (/^https?:\/\/www\.youtube.com\/watch\?/.test(window.location.href)) run();       </div><div class="line">  var isAjax=/class[\w\s"'-=]+spf\-link/.test(pagecontainer.innerHTML);</div><div class="line">  var logocontainer=document.getElementById('logo-container');  </div><div class="line">  if (logocontainer &amp;&amp; !isAjax) &#123; // fix for blocked videos</div><div class="line">    isAjax=(' '+logocontainer.className+' ').indexOf(' spf-link ')&gt;=0;</div><div class="line">  &#125;</div><div class="line">  var content=document.getElementById('content');</div><div class="line">  if (isAjax &amp;&amp; content) &#123; // Ajax UI</div><div class="line">      var mo=window.MutationObserver||window.WebKitMutationObserver;</div><div class="line">      if(typeof mo!=='undefined') &#123;</div><div class="line">        var observer=new mo(function(mutations) &#123;</div><div class="line">          mutations.forEach(function(mutation) &#123;</div><div class="line">              if(mutation.addedNodes!==null) &#123;</div><div class="line">                for (var i=0; i&lt;mutation.addedNodes.length; i++) &#123;</div><div class="line">                    if (mutation.addedNodes[i].id=='watch7-container' ||</div><div class="line">                        mutation.addedNodes[i].id=='watch7-main-container') &#123; // old value: movie_player</div><div class="line">                      run();</div><div class="line">                      break;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">              &#125;</div><div class="line">          &#125;);</div><div class="line">        &#125;);</div><div class="line">        observer.observe(content, &#123;childList: true, subtree: true&#125;); // old value: pagecontainer</div><div class="line">      &#125; else &#123; // MutationObserver fallback for old browsers</div><div class="line">        pagecontainer.addEventListener('DOMNodeInserted', onNodeInserted, false);</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function onNodeInserted(e) &#123;</div><div class="line">    if (e &amp;&amp; e.target &amp;&amp; (e.target.id=='watch7-container' ||</div><div class="line">        e.target.id=='watch7-main-container')) &#123; // old value: movie_player</div><div class="line">      run();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function run() &#123;</div><div class="line">  if (document.getElementById(CONTAINER_ID)) return; // check download container</div><div class="line">  if (document.getElementById('p') &amp;&amp; document.getElementById('vo')) return; // Feather not supported</div><div class="line"></div><div class="line">  var videoID, videoFormats, videoAdaptFormats, videoManifestURL, scriptURL=null;</div><div class="line">  var isSignatureUpdatingStarted=false;</div><div class="line">  var operaTable=new Array();</div><div class="line">  var language=document.documentElement.getAttribute('lang');</div><div class="line">  var textDirection='left';</div><div class="line">  if (document.body.getAttribute('dir')=='rtl') &#123;</div><div class="line">    textDirection='right';</div><div class="line">  &#125;</div><div class="line">  if (document.getElementById('watch7-action-buttons')) &#123;  // old UI</div><div class="line">    fixTranslations(language, textDirection);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  // obtain video ID, formats map   </div><div class="line"></div><div class="line">  var args=null;</div><div class="line">  var usw=(typeof this.unsafeWindow !== 'undefined')?this.unsafeWindow:window; // Firefox, Opera&lt;15</div><div class="line">  if (usw.ytplayer &amp;&amp; usw.ytplayer.config &amp;&amp; usw.ytplayer.config.args) &#123;</div><div class="line">    args=usw.ytplayer.config.args;</div><div class="line">  &#125;</div><div class="line">  if (args) &#123;</div><div class="line">    videoID=args['video_id'];</div><div class="line">    videoFormats=args['url_encoded_fmt_stream_map'];</div><div class="line">    videoAdaptFormats=args['adaptive_fmts'];</div><div class="line">    videoManifestURL=args['dashmpd'];</div><div class="line">    debug('DYVAM - Info: Standard mode. videoID '+(videoID?videoID:'none')+'; ');</div><div class="line">  &#125;</div><div class="line">  if (usw.ytplayer &amp;&amp; usw.ytplayer.config &amp;&amp; usw.ytplayer.config.assets) &#123;</div><div class="line">    scriptURL=usw.ytplayer.config.assets.js;</div><div class="line">  &#125;  </div><div class="line"></div><div class="line">  if (videoID==null) &#123; // unsafeWindow workaround (Chrome, Opera 15+)</div><div class="line">    var buffer=document.getElementById(DEBUG_ID+'2');</div><div class="line">    if (buffer) &#123;</div><div class="line">      while (buffer.firstChild) &#123;</div><div class="line">        buffer.removeChild(buffer.firstChild);</div><div class="line">      &#125;</div><div class="line">    &#125; else &#123;</div><div class="line">      buffer=createHiddenElem('pre', DEBUG_ID+'2');</div><div class="line">    &#125;    </div><div class="line">    injectScript ('if(ytplayer&amp;&amp;ytplayer.config&amp;&amp;ytplayer.config.args)&#123;document.getElementById("'+DEBUG_ID+'2").appendChild(document.createTextNode(\'"video_id":"\'+ytplayer.config.args.video_id+\'", "js":"\'+ytplayer.config.assets.js+\'", "dashmpd":"\'+ytplayer.config.args.dashmpd+\'", "url_encoded_fmt_stream_map":"\'+ytplayer.config.args.url_encoded_fmt_stream_map+\'", "adaptive_fmts":"\'+ytplayer.config.args.adaptive_fmts+\'"\'));&#125;');</div><div class="line">    var code=buffer.innerHTML;</div><div class="line">    if (code) &#123;</div><div class="line">      videoID=findMatch(code, /\"video_id\":\s*\"([^\"]+)\"/);</div><div class="line">      videoFormats=findMatch(code, /\"url_encoded_fmt_stream_map\":\s*\"([^\"]+)\"/);</div><div class="line">      videoFormats=videoFormats.replace(/&amp;amp;/g,'\\u0026');</div><div class="line">      videoAdaptFormats=findMatch(code, /\"adaptive_fmts\":\s*\"([^\"]+)\"/);</div><div class="line">      videoAdaptFormats=videoAdaptFormats.replace(/&amp;amp;/g,'\\u0026');</div><div class="line">      videoManifestURL=findMatch(code, /\"dashmpd\":\s*\"([^\"]+)\"/);</div><div class="line">      scriptURL=findMatch(code, /\"js\":\s*\"([^\"]+)\"/);</div><div class="line">    &#125;</div><div class="line">    debug('DYVAM - Info: Injection mode. videoID '+(videoID?videoID:'none')+'; ');</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  if (videoID==null) &#123; // if all else fails</div><div class="line">    var bodyContent=document.body.innerHTML;  </div><div class="line">    if (bodyContent!=null) &#123;</div><div class="line">      videoID=findMatch(bodyContent, /\"video_id\":\s*\"([^\"]+)\"/);</div><div class="line">      videoFormats=findMatch(bodyContent, /\"url_encoded_fmt_stream_map\":\s*\"([^\"]+)\"/);</div><div class="line">      videoAdaptFormats=findMatch(bodyContent, /\"adaptive_fmts\":\s*\"([^\"]+)\"/);</div><div class="line">      videoManifestURL=findMatch(bodyContent, /\"dashmpd\":\s*\"([^\"]+)\"/);</div><div class="line">      if (scriptURL==null) &#123;</div><div class="line">        scriptURL=findMatch(bodyContent, /\"js\":\s*\"([^\"]+)\"/);</div><div class="line">        if (scriptURL) &#123;</div><div class="line">          scriptURL=scriptURL.replace(/\\/g,'');</div><div class="line">        &#125;</div><div class="line">      &#125;      </div><div class="line">    &#125;</div><div class="line">    debug('DYVAM - Info: Brute mode. videoID '+(videoID?videoID:'none')+'; ');</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  debug('DYVAM - Info: url '+window.location.href+'; useragent '+window.navigator.userAgent);  </div><div class="line"></div><div class="line">  if (videoID==null || videoFormats==null || videoID.length==0 || videoFormats.length==0) &#123;</div><div class="line">   debug('DYVAM - Error: No config information found. YouTube must have changed the code.');</div><div class="line">   return;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  // Opera 12 extension message handler</div><div class="line">  if (typeof window.opera !== 'undefined' &amp;&amp; window.opera &amp;&amp; typeof opera.extension !== 'undefined') &#123;</div><div class="line">    opera.extension.onmessage = function(event) &#123;</div><div class="line">      var index=findMatch(event.data.action, /xhr\-([0-9]+)\-response/);</div><div class="line">      if (index &amp;&amp; operaTable[parseInt(index,10)]) &#123;</div><div class="line">        index=parseInt(index,10);</div><div class="line">        var trigger=(operaTable[index])['onload'];</div><div class="line">        if (typeof trigger === 'function' &amp;&amp; event.data.readyState == 4) &#123;</div><div class="line">          if (trigger) &#123;</div><div class="line">              trigger(event.data);         </div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  if (!isDecodeRuleUpdated) &#123;</div><div class="line">    DECODE_RULE=getDecodeRules(DECODE_RULE);</div><div class="line">    isDecodeRuleUpdated=true;</div><div class="line">  &#125;</div><div class="line">  if (scriptURL) &#123;</div><div class="line">    if (scriptURL.indexOf('//')==0) &#123;</div><div class="line">      var protocol=(document.location.protocol=='http:')?'http:':'https:';</div><div class="line">      scriptURL=protocol+scriptURL;</div><div class="line">    &#125;</div><div class="line">    fetchSignatureScript(scriptURL);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">   // video title</div><div class="line">   var videoTitle=document.title || 'video';</div><div class="line">   videoTitle=videoTitle.replace(/\s*\-\s*YouTube$/i, '').replace(/'/g, '\'').replace(/^\s+|\s+$/g, '').replace(/\.+$/g, '');</div><div class="line">   videoTitle=videoTitle.replace(/[:"\?\*]/g, '').replace(/[\|\\\/]/g, '_'); // Mac, Linux, Windows</div><div class="line">   if (((window.navigator.userAgent || '').toLowerCase()).indexOf('windows') &gt;= 0) &#123;</div><div class="line">      videoTitle=videoTitle.replace(/#/g, '').replace(/&amp;/g, '_'); // Windows</div><div class="line">   &#125; else &#123;</div><div class="line">      videoTitle=videoTitle.replace(/#/g, '%23').replace(/&amp;/g, '%26'); //  Mac, Linux</div><div class="line">   &#125;</div><div class="line"></div><div class="line">  // parse the formats map</div><div class="line">  var sep1='%2C', sep2='%26', sep3='%3D';</div><div class="line">  if (videoFormats.indexOf(',')&gt;-1) &#123;</div><div class="line">    sep1=',';</div><div class="line">    sep2=(videoFormats.indexOf('&amp;')&gt;-1)?'&amp;':'\\u0026';</div><div class="line">    sep3='=';</div><div class="line">  &#125;</div><div class="line">  var videoURL=new Array();</div><div class="line">  var videoSignature=new Array();</div><div class="line">  if (videoAdaptFormats) &#123;</div><div class="line">    videoFormats=videoFormats+sep1+videoAdaptFormats;</div><div class="line">  &#125;</div><div class="line">  var videoFormatsGroup=videoFormats.split(sep1);</div><div class="line">  for (var i=0;i&lt;videoFormatsGroup.length;i++) &#123;</div><div class="line">    var videoFormatsElem=videoFormatsGroup[i].split(sep2);</div><div class="line">    var videoFormatsPair=new Array();</div><div class="line">    for (var j=0;j&lt;videoFormatsElem.length;j++) &#123;</div><div class="line">      var pair=videoFormatsElem[j].split(sep3);</div><div class="line">      if (pair.length==2) &#123;</div><div class="line">        videoFormatsPair[pair[0]]=pair[1];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    if (videoFormatsPair['url']==null) continue;</div><div class="line">    var url=unescape(unescape(videoFormatsPair['url'])).replace(/\\\//g,'/').replace(/\\u0026/g,'&amp;');</div><div class="line">    if (videoFormatsPair['itag']==null) continue;</div><div class="line">    var itag=videoFormatsPair['itag'];</div><div class="line">    var sig=videoFormatsPair['sig']||videoFormatsPair['signature'];</div><div class="line">    if (sig) &#123;</div><div class="line">      url=url+'&amp;signature='+sig;</div><div class="line">      videoSignature[itag]=null;</div><div class="line">    &#125; else if (videoFormatsPair['s']) &#123;</div><div class="line">      url=url+'&amp;signature='+decryptSignature(videoFormatsPair['s']);</div><div class="line">      videoSignature[itag]=videoFormatsPair['s'];</div><div class="line">    &#125;</div><div class="line">    if (url.toLowerCase().indexOf('ratebypass')==-1) &#123; // speed up download for dash</div><div class="line">      url=url+'&amp;ratebypass=yes';</div><div class="line">    &#125;</div><div class="line">    if (url.toLowerCase().indexOf('http')==0) &#123; // validate URL</div><div class="line">      videoURL[itag]=url+'&amp;title='+videoTitle;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  var showFormat=new Array();</div><div class="line">  for (var category in FORMAT_RULE) &#123;</div><div class="line">    var rule=FORMAT_RULE[category];</div><div class="line">    for (var index in FORMAT_TYPE)&#123;</div><div class="line">      if (FORMAT_TYPE[index]==category) &#123;</div><div class="line">        showFormat[index]=(rule=='all');</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    if (rule=='max') &#123;</div><div class="line">      for (var i=FORMAT_ORDER.length-1;i&gt;=0;i--) &#123;</div><div class="line">        var format=FORMAT_ORDER[i];</div><div class="line">        if (FORMAT_TYPE[format]==category &amp;&amp; videoURL[format]!=undefined) &#123;</div><div class="line">          showFormat[format]=true;</div><div class="line">          break;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  var dashPref=getPref(STORAGE_DASH);</div><div class="line">  if (dashPref=='1') &#123;</div><div class="line">    SHOW_DASH_FORMATS=true;</div><div class="line">  &#125; else if (dashPref!='0') &#123;</div><div class="line">    setPref(STORAGE_DASH,'0');</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  var downloadCodeList=[];</div><div class="line">  for (var i=0;i&lt;FORMAT_ORDER.length;i++) &#123;</div><div class="line">    var format=FORMAT_ORDER[i];</div><div class="line">    if (format=='37' &amp;&amp; videoURL[format]==undefined) &#123; // hack for dash 1080p</div><div class="line">      if (videoURL['137']) &#123;</div><div class="line">       format='137';</div><div class="line">      &#125;</div><div class="line">      showFormat[format]=showFormat['37'];</div><div class="line">    &#125; else if (format=='38' &amp;&amp; videoURL[format]==undefined) &#123; // hack for dash 4K</div><div class="line">      if (videoURL['138'] &amp;&amp; !videoURL['266']) &#123;</div><div class="line">       format='138';</div><div class="line">      &#125;</div><div class="line">      showFormat[format]=showFormat['38'];</div><div class="line">    &#125;    </div><div class="line">    if (!SHOW_DASH_FORMATS &amp;&amp; format.length&gt;2) continue;</div><div class="line">    if (videoURL[format]!=undefined &amp;&amp; FORMAT_LABEL[format]!=undefined &amp;&amp; showFormat[format]) &#123;</div><div class="line">      downloadCodeList.push(&#123;url:videoURL[format],sig:videoSignature[format],format:format,label:FORMAT_LABEL[format]&#125;);</div><div class="line">      debug('DYVAM - Info: itag'+format+' url:'+videoURL[format]);</div><div class="line">    &#125;</div><div class="line">  &#125;  </div><div class="line"></div><div class="line">  if (downloadCodeList.length==0) &#123;</div><div class="line">    debug('DYVAM - Error: No download URL found. Probably YouTube uses encrypted streams.');</div><div class="line">    return; // no format</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  // find parent container</div><div class="line">  var newWatchPage=false;</div><div class="line">  var parentElement=document.getElementById('watch7-action-buttons');</div><div class="line">  if (parentElement==null) &#123;</div><div class="line">    parentElement=document.getElementById('watch8-secondary-actions');</div><div class="line">    if (parentElement==null) &#123;</div><div class="line">      debug('DYVAM Error - No container for adding the download button. YouTube must have changed the code.');</div><div class="line">      return;</div><div class="line">    &#125; else &#123;</div><div class="line">      newWatchPage=true;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  // get button labels</div><div class="line">  var buttonText=(BUTTON_TEXT[language])?BUTTON_TEXT[language]:BUTTON_TEXT['en'];</div><div class="line">  var buttonLabel=(BUTTON_TOOLTIP[language])?BUTTON_TOOLTIP[language]:BUTTON_TOOLTIP['en'];</div><div class="line"></div><div class="line">  // generate download code for regular interface</div><div class="line">  var mainSpan=document.createElement('span');</div><div class="line"></div><div class="line">  if (newWatchPage) &#123;</div><div class="line">    var spanIcon=document.createElement('span');</div><div class="line">    spanIcon.setAttribute('class', 'yt-uix-button-icon-wrapper');</div><div class="line">    var imageIcon=document.createElement('img');</div><div class="line">    imageIcon.setAttribute('src', '//s.ytimg.com/yt/img/pixel-vfl3z5WfW.gif');</div><div class="line">    imageIcon.setAttribute('class', 'yt-uix-button-icon');</div><div class="line">    imageIcon.setAttribute('style', 'width:20px;height:20px;background-size:20px 20px;background-repeat:no-repeat;background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABG0lEQVRYR+2W0Q3CMAxE2wkYAdiEEWADmIxuACMwCmzABpCTEmRSO7YTQX+ChECV43t2nF7GYeHPuLD+0AKwC/DnWMAp/N5qimkBuAfBdRTF/+2/AV6ZYFUxVYuicAfoHegd6B3oHfhZB+ByF+JyV8FkrAB74pqH3DU5L3iGoBURhdVODIQF4EjEkWLmmhYALOQgNIBcHHke4buhxXAAaFnaAhqbQ5QAOHHkwhZ8balkx1ICCiEBWNZ+CivdB7REHIC2ZjZK2oWklDDdB1NSdCd/Js2PqQMpSIKYVcM8kE6QCwDBNRCqOBJrW0CL8kCYxL0A1k6YxWsANAiXeC2ABOEWbwHAWrwxpzgkmA/JtIqnxTOElmPnjlkc4A3FykAhA42AxwAAAABJRU5ErkJggg==);');</div><div class="line">    spanIcon.appendChild(imageIcon);</div><div class="line">    mainSpan.appendChild(spanIcon);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  var spanButton=document.createElement('span');</div><div class="line">  spanButton.setAttribute('class', 'yt-uix-button-content');</div><div class="line">  spanButton.appendChild(document.createTextNode(buttonText+' '));</div><div class="line">  mainSpan.appendChild(spanButton);</div><div class="line"></div><div class="line">  if (!newWatchPage) &#123; // old UI</div><div class="line">    var imgButton=document.createElement('img');</div><div class="line">    imgButton.setAttribute('class', 'yt-uix-button-arrow');</div><div class="line">    imgButton.setAttribute('src', '//s.ytimg.com/yt/img/pixel-vfl3z5WfW.gif');</div><div class="line">    mainSpan.appendChild(imgButton);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  var listItems=document.createElement('ol');</div><div class="line">  listItems.setAttribute('style', 'display:none;');</div><div class="line">  listItems.setAttribute('class', 'yt-uix-button-menu');</div><div class="line">  for (var i=0;i&lt;downloadCodeList.length;i++) &#123;</div><div class="line">    var listItem=document.createElement('li');</div><div class="line">    var listLink=document.createElement('a');</div><div class="line">    listLink.setAttribute('style', 'text-decoration:none;');</div><div class="line">    listLink.setAttribute('href', downloadCodeList[i].url);</div><div class="line">    listLink.setAttribute('download', videoTitle+'.'+FORMAT_TYPE[downloadCodeList[i].format]);</div><div class="line">    var listButton=document.createElement('span');</div><div class="line">    listButton.setAttribute('class', 'yt-uix-button-menu-item');</div><div class="line">    listButton.setAttribute('loop', i+'');</div><div class="line">    listButton.setAttribute('id', LISTITEM_ID+downloadCodeList[i].format);</div><div class="line">    listButton.appendChild(document.createTextNode(downloadCodeList[i].label));</div><div class="line">    listLink.appendChild(listButton);</div><div class="line">    listItem.appendChild(listLink);</div><div class="line">    listItems.appendChild(listItem);</div><div class="line">  &#125;</div><div class="line">  mainSpan.appendChild(listItems);</div><div class="line">  var buttonElement=document.createElement('button');</div><div class="line">  buttonElement.setAttribute('id', BUTTON_ID);</div><div class="line">  if (newWatchPage) &#123;</div><div class="line">    buttonElement.setAttribute('class', 'yt-uix-button  yt-uix-button-size-default yt-uix-button-opacity yt-uix-tooltip');</div><div class="line">  &#125; else &#123; // old UI</div><div class="line">    buttonElement.setAttribute('class', 'yt-uix-button yt-uix-tooltip yt-uix-button-empty yt-uix-button-text');</div><div class="line">    buttonElement.setAttribute('style', 'margin-top:4px; margin-left:'+((textDirection=='left')?5:10)+'px;');</div><div class="line">  &#125;</div><div class="line">  buttonElement.setAttribute('data-tooltip-text', buttonLabel);  </div><div class="line">  buttonElement.setAttribute('type', 'button');</div><div class="line">  buttonElement.setAttribute('role', 'button');</div><div class="line">  buttonElement.addEventListener('click', function()&#123;return false;&#125;, false);</div><div class="line">  buttonElement.appendChild(mainSpan);</div><div class="line">  var containerSpan=document.createElement('span');</div><div class="line">  containerSpan.setAttribute('id', CONTAINER_ID);</div><div class="line">  containerSpan.appendChild(document.createTextNode(' '));</div><div class="line">  containerSpan.appendChild(buttonElement);</div><div class="line"></div><div class="line">  // add the button</div><div class="line">  if (!newWatchPage) &#123; // watch7</div><div class="line">    parentElement.appendChild(containerSpan);</div><div class="line">  &#125; else &#123; // watch8</div><div class="line">    parentElement.insertBefore(containerSpan, parentElement.firstChild);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  // REPLACEWITH if (!isSignatureUpdatingStarted) &#123;</div><div class="line">    for (var i=0;i&lt;downloadCodeList.length;i++) &#123;</div><div class="line">      addFileSize(downloadCodeList[i].url, downloadCodeList[i].format);</div><div class="line">    &#125;</div><div class="line">  // &#125;</div><div class="line"></div><div class="line">  if (typeof GM_download !== 'undefined') &#123;</div><div class="line">    for (var i=0;i&lt;downloadCodeList.length;i++) &#123;</div><div class="line">      var downloadFMT=document.getElementById(LISTITEM_ID+downloadCodeList[i].format);</div><div class="line">      var url=(downloadCodeList[i].url).toLowerCase();</div><div class="line">      if (url.indexOf('clen=')&gt;0 &amp;&amp; url.indexOf('dur=')&gt;0 &amp;&amp; url.indexOf('gir=')&gt;0</div><div class="line">          &amp;&amp; url.indexOf('lmt=')&gt;0) &#123;</div><div class="line">        downloadFMT.addEventListener('click', downloadVideoNatively, false);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  addFromManifest();</div><div class="line"></div><div class="line">  function downloadVideoNatively(e) &#123;</div><div class="line">    var elem=e.currentTarget;</div><div class="line">    e.returnValue=false;    </div><div class="line">    if (e.preventDefault) &#123;</div><div class="line">      e.preventDefault();</div><div class="line">    &#125;</div><div class="line">    var loop=elem.getAttribute('loop');</div><div class="line">    if (loop) &#123;</div><div class="line">      GM_download(downloadCodeList[loop].url, videoTitle+'.'+FORMAT_TYPE[downloadCodeList[loop].format]);</div><div class="line">    &#125;</div><div class="line">    return false;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function addFromManifest() &#123; // add Dash URLs from manifest file</div><div class="line">    var formats=['137', '138', '140']; // 137=1080p, 138=4k, 140=m4a</div><div class="line">    var isNecessary=true;</div><div class="line">    for (var i=0;i&lt;formats.length;i++) &#123;</div><div class="line">      if (videoURL[formats[i]]) &#123;</div><div class="line">        isNecessary=false;</div><div class="line">        break;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    if (videoManifestURL &amp;&amp; SHOW_DASH_FORMATS &amp;&amp; isNecessary) &#123;</div><div class="line">      var matchSig=findMatch(videoManifestURL, /\/s\/([a-zA-Z0-9\.]+)\//i);</div><div class="line">      if (matchSig) &#123;</div><div class="line">        var decryptedSig=decryptSignature(matchSig);</div><div class="line">        if (decryptedSig) &#123;</div><div class="line">          videoManifestURL=videoManifestURL.replace('/s/'+matchSig+'/','/signature/'+decryptedSig+'/');</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      if (videoManifestURL.indexOf('//')==0) &#123;</div><div class="line">        var protocol=(document.location.protocol=='http:')?'http:':'https:';</div><div class="line">        videoManifestURL=protocol+videoManifestURL;</div><div class="line">      &#125;</div><div class="line">      debug('DYVAM - Info: manifestURL '+videoManifestURL);</div><div class="line">      crossXmlHttpRequest(&#123;</div><div class="line">          method:'GET',</div><div class="line">          url:videoManifestURL, // check if URL exists</div><div class="line">          onload:function(response) &#123;</div><div class="line">            if (response.readyState === 4 &amp;&amp; response.status === 200 &amp;&amp; response.responseText) &#123;</div><div class="line">              debug('DYVAM - Info: maniestFileContents '+response.responseText);</div><div class="line">              var lastFormatFromList=downloadCodeList[downloadCodeList.length-1].format;</div><div class="line">              debug('DYVAM - Info: lastformat: '+lastFormatFromList);</div><div class="line">              for (var i=0;i&lt;formats.length;i++) &#123;</div><div class="line">                k=formats[i];</div><div class="line">                if (videoURL[k] || showFormat[k]==false) continue;</div><div class="line">                var regexp = new RegExp('&lt;BaseURL&gt;(http[^&lt;]+itag\\/'+k+'[^&lt;]+)&lt;\\/BaseURL&gt;','i');</div><div class="line">                var matchURL=findMatch(response.responseText, regexp);</div><div class="line">                debug('DYVAM - Info: matchURL itag= '+k+' url= '+matchURL);</div><div class="line">                if (!matchURL) continue;</div><div class="line">                matchURL=matchURL.replace(/&amp;amp\;/g,'&amp;');</div><div class="line">                // ...</div><div class="line">                downloadCodeList.push(</div><div class="line">                  &#123;url:matchURL,sig:videoSignature[k],format:k,label:FORMAT_LABEL[k]&#125;);</div><div class="line">                var downloadFMT=document.getElementById(LISTITEM_ID+lastFormatFromList);</div><div class="line">                var clone=downloadFMT.parentNode.parentNode.cloneNode(true);</div><div class="line">                clone.firstChild.firstChild.setAttribute('id', LISTITEM_ID+k);</div><div class="line">                clone.firstChild.setAttribute('href', matchURL);</div><div class="line">                downloadFMT.parentNode.parentNode.parentNode.appendChild(clone);</div><div class="line">                downloadFMT=document.getElementById(LISTITEM_ID+k);</div><div class="line">                downloadFMT.firstChild.nodeValue=FORMAT_LABEL[k];</div><div class="line">                addFileSize(matchURL, k);</div><div class="line">                lastFormatFromList=k;</div><div class="line">              &#125;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;  </div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function injectStyle(code) &#123;</div><div class="line">    var style=document.createElement('style');</div><div class="line">    style.type='text/css';</div><div class="line">    style.appendChild(document.createTextNode(code));</div><div class="line">    document.getElementsByTagName('head')[0].appendChild(style);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function injectScript(code) &#123;</div><div class="line">    var script=document.createElement('script');</div><div class="line">    script.type='application/javascript';</div><div class="line">    script.textContent=code;</div><div class="line">    document.body.appendChild(script);</div><div class="line">    document.body.removeChild(script);</div><div class="line">  &#125;    </div><div class="line"></div><div class="line">  function debug(str) &#123;</div><div class="line">    var debugElem=document.getElementById(DEBUG_ID);</div><div class="line">    if (!debugElem) &#123;</div><div class="line">      debugElem=createHiddenElem('div', DEBUG_ID);</div><div class="line">    &#125;</div><div class="line">    debugElem.appendChild(document.createTextNode(str+' '));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function createHiddenElem(tag, id) &#123;</div><div class="line">    var elem=document.createElement(tag);</div><div class="line">    elem.setAttribute('id', id);</div><div class="line">    elem.setAttribute('style', 'display:none;');</div><div class="line">    document.body.appendChild(elem);</div><div class="line">    return elem;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function fixTranslations(language, textDirection) &#123;  </div><div class="line">    if (/^af|bg|bn|ca|cs|de|el|es|et|eu|fa|fi|fil|fr|gl|hi|hr|hu|id|it|iw|kn|lv|lt|ml|mr|ms|nl|pl|ro|ru|sl|sk|sr|sw|ta|te|th|uk|ur|vi|zu$/.test(language)) &#123; // fix international UI</div><div class="line">      var likeButton=document.getElementById('watch-like');</div><div class="line">      if (likeButton) &#123;</div><div class="line">        var spanElements=likeButton.getElementsByClassName('yt-uix-button-content');</div><div class="line">        if (spanElements) &#123;</div><div class="line">          spanElements[0].style.display='none'; // hide like text</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      var marginPixels=10;</div><div class="line">      if (/^bg|ca|cs|el|eu|hr|it|ml|ms|pl|sl|sw|te$/.test(language)) &#123;</div><div class="line">        marginPixels=1;</div><div class="line">      &#125;</div><div class="line">      injectStyle('#watch7-secondary-actions .yt-uix-button&#123;margin-'+textDirection+':'+marginPixels+'px!important&#125;');</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function findMatch(text, regexp) &#123;</div><div class="line">    var matches=text.match(regexp);</div><div class="line">    return (matches)?matches[1]:null;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function isString(s) &#123;</div><div class="line">    return (typeof s==='string' || s instanceof String);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function isInteger(n) &#123;</div><div class="line">    return (typeof n==='number' &amp;&amp; n%1==0);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function getPref(name) &#123; // cross-browser GM_getValue</div><div class="line">    var a='', b='';</div><div class="line">    try &#123;a=typeof GM_getValue.toString; b=GM_getValue.toString()&#125; catch(e)&#123;&#125;    </div><div class="line">    if (typeof GM_getValue === 'function' &amp;&amp;</div><div class="line">    (a === 'undefined' || b.indexOf('not supported') === -1)) &#123;</div><div class="line">      return GM_getValue(name, null); // Greasemonkey, Tampermonkey, Firefox extension</div><div class="line">    &#125; else &#123;</div><div class="line">        var ls=null;</div><div class="line">        try &#123;ls=window.localStorage||null&#125; catch(e)&#123;&#125;</div><div class="line">        if (ls) &#123;</div><div class="line">          return ls.getItem(name); // Chrome script, Opera extensions</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function setPref(name, value) &#123; //  cross-browser GM_setValue</div><div class="line">    var a='', b='';</div><div class="line">    try &#123;a=typeof GM_setValue.toString; b=GM_setValue.toString()&#125; catch(e)&#123;&#125;    </div><div class="line">    if (typeof GM_setValue === 'function' &amp;&amp;</div><div class="line">    (a === 'undefined' || b.indexOf('not supported') === -1)) &#123;</div><div class="line">      GM_setValue(name, value); // Greasemonkey, Tampermonkey, Firefox extension</div><div class="line">    &#125; else &#123;</div><div class="line">        var ls=null;</div><div class="line">        try &#123;ls=window.localStorage||null&#125; catch(e)&#123;&#125;</div><div class="line">        if (ls) &#123;</div><div class="line">          return ls.setItem(name, value); // Chrome script, Opera extensions</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function crossXmlHttpRequest(details) &#123; // cross-browser GM_xmlhttpRequest</div><div class="line">    if (typeof GM_xmlhttpRequest === 'function') &#123; // Greasemonkey, Tampermonkey, Firefox extension, Chrome script</div><div class="line">      GM_xmlhttpRequest(details);</div><div class="line">    &#125; else if (typeof window.opera !== 'undefined' &amp;&amp; window.opera &amp;&amp; typeof opera.extension !== 'undefined' &amp;&amp;</div><div class="line">               typeof opera.extension.postMessage !== 'undefined') &#123; // Opera 12 extension</div><div class="line">        var index=operaTable.length;</div><div class="line">        opera.extension.postMessage(&#123;'action':'xhr-'+index, 'url':details.url, 'method':details.method&#125;);</div><div class="line">        operaTable[index]=details;</div><div class="line">    &#125; else if (typeof window.opera === 'undefined' &amp;&amp; typeof XMLHttpRequest === 'function') &#123; // Opera 15+ extension</div><div class="line">        var xhr=new XMLHttpRequest();</div><div class="line">        xhr.onreadystatechange = function() &#123;</div><div class="line">          if (xhr.readyState == 4) &#123;</div><div class="line">            if (details['onload']) &#123;</div><div class="line">              details['onload'](xhr);</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">        xhr.open(details.method, details.url, true);</div><div class="line">        xhr.send();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function addFileSize(url, format) &#123;</div><div class="line"></div><div class="line">    function updateVideoLabel(size, format) &#123;</div><div class="line">      var elem=document.getElementById(LISTITEM_ID+format);</div><div class="line">      if (elem) &#123;</div><div class="line">        size=parseInt(size,10);</div><div class="line">        if (size&gt;=1073741824) &#123;</div><div class="line">          size=parseFloat((size/1073741824).toFixed(1))+' GB';</div><div class="line">        &#125; else if (size&gt;=1048576) &#123;</div><div class="line">          size=parseFloat((size/1048576).toFixed(1))+' MB';</div><div class="line">        &#125; else &#123;</div><div class="line">          size=parseFloat((size/1024).toFixed(1))+' KB';</div><div class="line">        &#125;</div><div class="line">        if (elem.childNodes.length&gt;1) &#123;</div><div class="line">            elem.lastChild.nodeValue=' ('+size+')';</div><div class="line">        &#125; else if (elem.childNodes.length==1) &#123;</div><div class="line">            elem.appendChild(document.createTextNode(' ('+size+')'));</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    var matchSize=findMatch(url, /[&amp;\?]clen=([0-9]+)&amp;/i);</div><div class="line">    if (matchSize) &#123;</div><div class="line">      updateVideoLabel(matchSize, format);</div><div class="line">    &#125; else &#123;</div><div class="line">      try &#123;</div><div class="line">        crossXmlHttpRequest(&#123;</div><div class="line">          method:'HEAD',</div><div class="line">          url:url,</div><div class="line">          onload:function(response) &#123;</div><div class="line">            if (response.readyState == 4 &amp;&amp; response.status == 200) &#123; // add size</div><div class="line">              var size=0;</div><div class="line">              if (typeof response.getResponseHeader === 'function') &#123;</div><div class="line">                size=response.getResponseHeader('Content-length');</div><div class="line">              &#125; else if (response.responseHeaders) &#123;</div><div class="line">                  var regexp = new RegExp('^Content\-length: (.*)$','im');</div><div class="line">                  var match = regexp.exec(response.responseHeaders);</div><div class="line">                  if (match) &#123;</div><div class="line">                    size=match[1];</div><div class="line">                  &#125;</div><div class="line">              &#125;</div><div class="line">              if (size) &#123;</div><div class="line">                updateVideoLabel(size, format);</div><div class="line">              &#125;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;);</div><div class="line">      &#125; catch(e) &#123; &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function findSignatureCode(sourceCode) &#123;</div><div class="line">    debug('DYVAM - Info: signature start '+getPref(STORAGE_CODE));</div><div class="line">    var signatureFunctionName =</div><div class="line">    findMatch(sourceCode,</div><div class="line">    /\.set\s*\("signature"\s*,\s*([a-zA-Z0-9_$][\w$]*)\(/)</div><div class="line">    || findMatch(sourceCode,</div><div class="line">    /\.sig\s*\|\|\s*([a-zA-Z0-9_$][\w$]*)\(/)</div><div class="line">    || findMatch(sourceCode,</div><div class="line">    /\.signature\s*=\s*([a-zA-Z_$][\w$]*)\([a-zA-Z_$][\w$]*\)/); //old</div><div class="line">    if (signatureFunctionName == null) return setPref(STORAGE_CODE, 'error');</div><div class="line">    signatureFunctionName=signatureFunctionName.replace('$','\\$');    </div><div class="line">    var regCode = new RegExp(signatureFunctionName + '\\s*=\\s*function' +</div><div class="line">    '\\s*\\([\\w$]*\\)\\s*&#123;[\\w$]*=[\\w$]*\\.split\\(""\\);\n*(.+);return [\\w$]*\\.join');</div><div class="line">    var regCode2 = new RegExp('function \\s*' + signatureFunctionName +</div><div class="line">    '\\s*\\([\\w$]*\\)\\s*&#123;[\\w$]*=[\\w$]*\\.split\\(""\\);\n*(.+);return [\\w$]*\\.join');    </div><div class="line">    var functionCode = findMatch(sourceCode, regCode) || findMatch(sourceCode, regCode2);</div><div class="line">    debug('DYVAM - Info: signaturefunction ' + signatureFunctionName + ' -- ' + functionCode);            </div><div class="line">    if (functionCode == null) return setPref(STORAGE_CODE, 'error');</div><div class="line"></div><div class="line">    var reverseFunctionName = findMatch(sourceCode,</div><div class="line">    /([\w$]*)\s*:\s*function\s*\(\s*[\w$]*\s*\)\s*&#123;\s*(?:return\s*)?[\w$]*\.reverse\s*\(\s*\)\s*&#125;/);</div><div class="line">    debug('DYVAM - Info: reversefunction ' + reverseFunctionName);</div><div class="line">    if (reverseFunctionName) reverseFunctionName=reverseFunctionName.replace('$','\\$');        </div><div class="line">    var sliceFunctionName = findMatch(sourceCode,</div><div class="line">    /([\w$]*)\s*:\s*function\s*\(\s*[\w$]*\s*,\s*[\w$]*\s*\)\s*&#123;\s*(?:return\s*)?[\w$]*\.(?:slice|splice)\(.+\)\s*&#125;/);</div><div class="line">    debug('DYVAM - Info: slicefunction ' + sliceFunctionName);</div><div class="line">    if (sliceFunctionName) sliceFunctionName=sliceFunctionName.replace('$','\\$');    </div><div class="line"></div><div class="line">    var regSlice = new RegExp('\\.(?:'+'slice'+(sliceFunctionName?'|'+sliceFunctionName:'')+</div><div class="line">    ')\\s*\\(\\s*(?:[a-zA-Z_$][\\w$]*\\s*,)?\\s*([0-9]+)\\s*\\)'); // .slice(5) sau .Hf(a,5)</div><div class="line">    var regReverse = new RegExp('\\.(?:'+'reverse'+(reverseFunctionName?'|'+reverseFunctionName:'')+</div><div class="line">    ')\\s*\\([^\\)]*\\)');  // .reverse() sau .Gf(a,45)</div><div class="line">    var regSwap = new RegExp('[\\w$]+\\s*\\(\\s*[\\w$]+\\s*,\\s*([0-9]+)\\s*\\)');</div><div class="line">    var regInline = new RegExp('[\\w$]+\\[0\\]\\s*=\\s*[\\w$]+\\[([0-9]+)\\s*%\\s*[\\w$]+\\.length\\]');</div><div class="line">    var functionCodePieces=functionCode.split(';');</div><div class="line">    var decodeArray=[];</div><div class="line">    for (var i=0; i&lt;functionCodePieces.length; i++) &#123;</div><div class="line">      functionCodePieces[i]=functionCodePieces[i].trim();</div><div class="line">      var codeLine=functionCodePieces[i];</div><div class="line">      if (codeLine.length&gt;0) &#123;</div><div class="line">        var arrSlice=codeLine.match(regSlice);</div><div class="line">        var arrReverse=codeLine.match(regReverse);</div><div class="line">        debug(i+': '+codeLine+' --'+(arrSlice?' slice length '+arrSlice.length:'') +' '+(arrReverse?'reverse':''));</div><div class="line">        if (arrSlice &amp;&amp; arrSlice.length &gt;= 2) &#123; // slice</div><div class="line">        var slice=parseInt(arrSlice[1], 10);</div><div class="line">        if (isInteger(slice))&#123;</div><div class="line">          decodeArray.push(-slice);</div><div class="line">        &#125; else return setPref(STORAGE_CODE, 'error');</div><div class="line">      &#125; else if (arrReverse &amp;&amp; arrReverse.length &gt;= 1) &#123; // reverse</div><div class="line">        decodeArray.push(0);</div><div class="line">      &#125; else if (codeLine.indexOf('[0]') &gt;= 0) &#123; // inline swap</div><div class="line">          if (i+2&lt;functionCodePieces.length &amp;&amp;</div><div class="line">          functionCodePieces[i+1].indexOf('.length') &gt;= 0 &amp;&amp;</div><div class="line">          functionCodePieces[i+1].indexOf('[0]') &gt;= 0) &#123;</div><div class="line">            var inline=findMatch(functionCodePieces[i+1], regInline);</div><div class="line">            inline=parseInt(inline, 10);</div><div class="line">            decodeArray.push(inline);</div><div class="line">            i+=2;</div><div class="line">          &#125; else return setPref(STORAGE_CODE, 'error');</div><div class="line">      &#125; else if (codeLine.indexOf(',') &gt;= 0) &#123; // swap</div><div class="line">        var swap=findMatch(codeLine, regSwap);      </div><div class="line">        swap=parseInt(swap, 10);</div><div class="line">        if (isInteger(swap) &amp;&amp; swap&gt;0)&#123;</div><div class="line">          decodeArray.push(swap);</div><div class="line">        &#125; else return setPref(STORAGE_CODE, 'error');</div><div class="line">      &#125; else return setPref(STORAGE_CODE, 'error');</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (decodeArray) &#123;</div><div class="line">      setPref(STORAGE_URL, scriptURL);</div><div class="line">      setPref(STORAGE_CODE, decodeArray.toString());</div><div class="line">      DECODE_RULE=decodeArray;</div><div class="line">      debug('DYVAM - Info: signature '+decodeArray.toString()+' '+scriptURL);</div><div class="line">      // update download links and add file sizes</div><div class="line">      for (var i=0;i&lt;downloadCodeList.length;i++) &#123;        </div><div class="line">        var elem=document.getElementById(LISTITEM_ID+downloadCodeList[i].format);</div><div class="line">        var url=downloadCodeList[i].url;</div><div class="line">        var sig=downloadCodeList[i].sig;</div><div class="line">        if (elem &amp;&amp; url &amp;&amp; sig) &#123;</div><div class="line">          url=url.replace(/\&amp;signature=[\w\.]+/, '&amp;signature='+decryptSignature(sig));</div><div class="line">          elem.parentNode.setAttribute('href', url);</div><div class="line">          addFileSize(url, downloadCodeList[i].format);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function isValidSignatureCode(arr) &#123; // valid values: '5,-3,0,2,5', 'error'</div><div class="line">    if (!arr) return false;</div><div class="line">    if (arr=='error') return true;</div><div class="line">    arr=arr.split(',');</div><div class="line">    for (var i=0;i&lt;arr.length;i++) &#123;</div><div class="line">      if (!isInteger(parseInt(arr[i],10))) return false;</div><div class="line">    &#125;</div><div class="line">    return true;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function fetchSignatureScript(scriptURL) &#123;</div><div class="line">    var storageURL=getPref(STORAGE_URL);</div><div class="line">    var storageCode=getPref(STORAGE_CODE);</div><div class="line">    if (!(/,0,|^0,|,0$|\-/.test(storageCode))) storageCode=null; // hack for only positive items</div><div class="line">    if (storageCode &amp;&amp; isValidSignatureCode(storageCode) &amp;&amp; storageURL &amp;&amp;</div><div class="line">        scriptURL.replace(/^https?/i,'')==storageURL.replace(/^https?/i,'')) return;</div><div class="line">    try &#123;</div><div class="line">      debug('DYVAM fetch '+scriptURL);</div><div class="line">      isSignatureUpdatingStarted=true;    </div><div class="line">      crossXmlHttpRequest(&#123;</div><div class="line">        method:'GET',</div><div class="line">        url:scriptURL,</div><div class="line">        onload:function(response) &#123;</div><div class="line">          debug('DYVAM fetch status '+response.status);</div><div class="line">          if (response.readyState === 4 &amp;&amp; response.status === 200 &amp;&amp; response.responseText) &#123;</div><div class="line">            findSignatureCode(response.responseText);</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125; catch(e) &#123; &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function getDecodeRules(rules) &#123;</div><div class="line">    var storageCode=getPref(STORAGE_CODE);    </div><div class="line">    if (storageCode &amp;&amp; storageCode!='error' &amp;&amp; isValidSignatureCode(storageCode)) &#123;</div><div class="line">      var arr=storageCode.split(',');</div><div class="line">      for (var i=0; i&lt;arr.length; i++) &#123;</div><div class="line">        arr[i]=parseInt(arr[i], 10);</div><div class="line">      &#125;</div><div class="line">      rules=arr;</div><div class="line">      debug('DYVAM - Info: signature '+arr.toString()+' '+scriptURL);</div><div class="line">    &#125;</div><div class="line">    return rules;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function decryptSignature(sig) &#123;</div><div class="line">    function swap(a,b)&#123;var c=a[0];a[0]=a[b%a.length];a[b]=c;return a&#125;;</div><div class="line">    function decode(sig, arr) &#123; // encoded decryption</div><div class="line">      if (!isString(sig)) return null;</div><div class="line">      var sigA=sig.split('');</div><div class="line">      for (var i=0;i&lt;arr.length;i++) &#123;</div><div class="line">        var act=arr[i];</div><div class="line">        if (!isInteger(act)) return null;</div><div class="line">        sigA=(act&gt;0)?swap(sigA, act):((act==0)?sigA.reverse():sigA.slice(-act));</div><div class="line">      &#125;</div><div class="line">      var result=sigA.join('');</div><div class="line">      return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (sig==null) return '';    </div><div class="line">    var arr=DECODE_RULE;</div><div class="line">    if (arr) &#123;</div><div class="line">      var sig2=decode(sig, arr);</div><div class="line">      if (sig2) return sig2;</div><div class="line">    &#125; else &#123;</div><div class="line">      setPref(STORAGE_URL, '');</div><div class="line">      setPref(STORAGE_CODE, '');</div><div class="line">    &#125;</div><div class="line">    return sig;</div><div class="line">  &#125;  </div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;)();</div></pre></td></tr></table></figure>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
                    
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="friends/index.html" 
            data-url="http://beamaster.github.io/friends/index.html"
            data-title="friends"></div>
    <!-- 多说评论框 end -->
</div>



                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Steam's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        steamshi@email.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="#" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">3</span></a>
        </ul>
    </li>
	
    <!-- Categories  -->
<!--
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">view_list</i>
             分类
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            
        </ul>
    </li>
-->

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
		<li>
			<a href="/about" title="about">
				about
			</a>
		</li>
	
		<li>
			<a href="/friends" title="friends">
				friends
			</a>
		</li>
	
		<li>
			<a href="/favorite" title="favorite">
				favorite
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">16</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    

    <!-- Facebook -->
    
    

    <!-- Google + -->
    
    

    <!-- Weibo -->
    
    <a href="http://weibo.com/steamQ/" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    

    <!-- Instagram -->
    
    

    <!-- Tumblr -->
    
    

    <!-- Github -->
    
    <a href="https://github.com/beamaster" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    

    <!-- LinkedIn -->
    
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;让正确的事情持续发生——永远年轻，永远热泪盈眶</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>






    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"forsigner"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->

	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
        var inputArea = document.querySelector("#search");
        var getSearchFile = function(){
            var path = "search.xml";
            searchFunc(path, 'search', 'local-search-result');
        }

        inputArea.onfocus = function(){ getSearchFile() }
	</script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
